{% extends "admin/change_form.html" %}
{% block content %}
<div style="display: flex; gap: 20px;">
  <div style="width: 300px;">
    <canvas id="chart"></canvas>
  </div>

</div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const ctx = document.getElementById('chart').getContext('2d');
    const labels = {{ chart_labels|safe }};
    const data = {{ chart_data|safe }};
    const total = data.reduce((a, b) => a + b, 0);

    new Chart(ctx, {
      type: 'pie',
      data: {
        labels: labels,
        datasets: [{
          label: 'Call Purpose',
          data: data,
          backgroundColor: ['#36A2EB', '#FF6384'],
        }]
      },
      options: {
        plugins: {
          tooltip: {
            callbacks: {
              label: function(context) {
                let count = context.raw;
                let percentage = ((count / total) * 100).toFixed(1);
                return `${context.label}: ${count} (${percentage}%)`;
              }
            }
          },
          legend: {
            position: 'top'
          }
        }
      }
    });
  </script>
  {{ block.super }}
{% endblock %}

